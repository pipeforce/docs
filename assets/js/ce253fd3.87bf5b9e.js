"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[9285],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>c});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=a.createContext({}),d=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=d(e.components);return a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,p=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),u=d(n),c=i,h=u["".concat(p,".").concat(c)]||u[c]||s[c]||l;return n?a.createElement(h,r(r({ref:t},m),{},{components:n})):a.createElement(h,r({ref:t},m))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,r=new Array(l);r[0]=u;var o={};for(var p in t)hasOwnProperty.call(t,p)&&(o[p]=t[p]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var d=2;d<l;d++)r[d]=n[d];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},2631:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>r,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const l={},r="HTTP API",o={unversionedId:"guides/commands_pipelines/http_api",id:"guides/commands_pipelines/http_api",isDocsHomePage:!1,title:"HTTP API",description:"Commands and pipelines can be executed using a HTTP API which is similar to RESTful endpoints. The HTTP request methods POST and GET, the HTTP header Content-Type and the request body define, how commands and pipelines are executed and which parameters and message body values are set.",source:"@site/docs/guides/commands_pipelines/15_http_api.md",sourceDirName:"guides/commands_pipelines",slug:"/guides/commands_pipelines/http_api",permalink:"/docs/guides/commands_pipelines/http_api",editUrl:"https://github.com/pipeforce/pipeforce.github.io/edit/master/docs/guides/commands_pipelines/15_http_api.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Basics",permalink:"/docs/commands_pipelines"},next:{title:"Pipeline Expression Language",permalink:"/docs/guides/commands_pipelines/pel"}},p=[{value:"HTTP API for single commands calls",id:"http-api-for-single-commands-calls",children:[{value:"HTTP Methods",id:"http-methods",children:[],level:3},{value:"Example 1: No body",id:"example-1-no-body",children:[],level:3},{value:"Example 2: With JSON in body",id:"example-2-with-json-in-body",children:[],level:3},{value:"Example 3: With binary data in body",id:"example-3-with-binary-data-in-body",children:[],level:3},{value:"Example 4: With multipart body",id:"example-4-with-multipart-body",children:[],level:3}],level:2},{value:"HTTP API for pipeline calls",id:"http-api-for-pipeline-calls",children:[{value:"HTTP Methods",id:"http-methods-1",children:[],level:3},{value:"Example 1: No body",id:"example-1-no-body-1",children:[],level:3},{value:"Example 2: With body embedded",id:"example-2-with-body-embedded",children:[],level:3},{value:"Example 3: With body",id:"example-3-with-body",children:[],level:3},{value:"Example 4: With multipart body",id:"example-4-with-multipart-body-1",children:[],level:3}],level:2},{value:"Report an Issue",id:"report-an-issue",children:[],level:2}],d={toc:p};function m(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"http-api"},"HTTP API"),(0,i.kt)("p",null," Commands and pipelines can be executed using a HTTP API which is similar to RESTful endpoints. The HTTP request methods ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"GET"),", the HTTP header ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," and the request body define, how commands and pipelines are executed and which parameters and message body values are set."),(0,i.kt)("p",null," The return value depends on the command or the pipeline and is mostly a JSON document.  "),(0,i.kt)("p",null," It's important to understand, that you have two options to call the backend using the HTTP API:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"A single Command"),(0,i.kt)("li",{parentName:"ul"},"A chain of Commands using a Pipeline script")),(0,i.kt)("p",null,"Below, these two options will be explained in more detail."),(0,i.kt)("h2",{id:"http-api-for-single-commands-calls"},"HTTP API for single commands calls"),(0,i.kt)("p",null," You can call a single command using a HTTP request with the endpoint ",(0,i.kt)("inlineCode",{parentName:"p"},"/api/v3/command/{name}")," wheras ",(0,i.kt)("inlineCode",{parentName:"p"},"{name}")," needs to be replaced by the name of the command. The optional request parameters will become the command parameters. See ",(0,i.kt)("a",{parentName:"p",href:"/docs/api/commands"},"here")," for a reference of all built-in commands. Using the request header ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," and the request body, you can optionally set the message body for the command."),(0,i.kt)("h3",{id:"http-methods"},"HTTP Methods"),(0,i.kt)("p",null,"You can call the command endpoint ",(0,i.kt)("inlineCode",{parentName:"p"},"/command/{name}")," using different HTTP options:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Method"),(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"th"},"Content-Type")),(0,i.kt)("th",{parentName:"tr",align:null},"Request Body"),(0,i.kt)("th",{parentName:"tr",align:null},"Message Body"),(0,i.kt)("th",{parentName:"tr",align:null},"Execution"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"GET")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"None")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"None")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"None")),(0,i.kt)("td",{parentName:"tr",align:null},"A single command given by ",(0,i.kt)("inlineCode",{parentName:"td"},"{name}")," with paremters set from request parameters and a ",(0,i.kt)("inlineCode",{parentName:"td"},"null")," body.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"POST")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"application/json")),(0,i.kt)("td",{parentName:"tr",align:null},"A JSON data document"),(0,i.kt)("td",{parentName:"tr",align:null},"A parsed JSON data object"),(0,i.kt)("td",{parentName:"tr",align:null},"A single command given by ",(0,i.kt)("inlineCode",{parentName:"td"},"{name}")," with paremters set from request parameters and the JSON object in the body.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"POST")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"multipart/form-data")),(0,i.kt)("td",{parentName:"tr",align:null},"One or more parts with ",(0,i.kt)("inlineCode",{parentName:"td"},'name="file"')," in the content disposition header. See ",(0,i.kt)("a",{parentName:"td",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST"},"how HTTP multipart works"),"."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"/docs/guides/contentobject"},"Content Collection")," with each entry referencing a part data."),(0,i.kt)("td",{parentName:"tr",align:null},"A single command given by ",(0,i.kt)("inlineCode",{parentName:"td"},"{name}")," with paremters set from request parameters and a content collection in the body.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"POST")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("em",{parentName:"td"},"Any")),(0,i.kt)("td",{parentName:"tr",align:null},"Any (binary) data format as specified by the ",(0,i.kt)("inlineCode",{parentName:"td"},"Content-Type")," Note: Additionally the header ",(0,i.kt)("inlineCode",{parentName:"td"},"Content-Length")," is mandatory in this case."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("a",{parentName:"td",href:"/docs/guides/contentobject"},"Content Object")," referencing the data in the request body as a stream."),(0,i.kt)("td",{parentName:"tr",align:null},"A single command given by ",(0,i.kt)("inlineCode",{parentName:"td"},"{name}")," with paremters set from request parameters and a content object in the body. This is the most effective way of uploading large data to a command.")))),(0,i.kt)("h3",{id:"example-1-no-body"},"Example 1: No body"),(0,i.kt)("p",null,"In case you would like to execute a single command without a body, you could execute a curl like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -u "username:password" \\\n  -X GET "https://hub-trial.pipeforce.org/api/v3/command/log?message=HELLO"\n')),(0,i.kt)("h3",{id:"example-2-with-json-in-body"},"Example 2: With JSON in body"),(0,i.kt)("p",null,"In case you would like to execute a single command with a JSON document as body data, you could execute this curl:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -u 'username:password' \\\n  -H 'Content-Type: application/json'\n  -X POST 'https://hub-trial.pipeforce.org/api/v3/command/property.put?key=someKey' \\\n  -d '{\"name\": \"someValue\"}'\n")),(0,i.kt)("h3",{id:"example-3-with-binary-data-in-body"},"Example 3: With binary data in body"),(0,i.kt)("p",null,"In case you would like to execute a single command with a binary data in the body, you could execute this curl, which uploads the content of a local PDF file to a command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"curl -u 'username:password' \\\n  -H 'Content-Type: application/pdf'\n  -X POST 'https://hub-trial.pipeforce.org/api/v3/command/property.attachment.put?key=someKey&name=my.pdf' \\\n  --data-binary \"@my.pdf\"\n")),(0,i.kt)("h3",{id:"example-4-with-multipart-body"},"Example 4: With multipart body"),(0,i.kt)("p",null,"In case you would like to execute a single command with multiple parts (files) uploaded and provided in the body, you can use a curl like this:"),(0,i.kt)("p",null,"TODO"),(0,i.kt)("h2",{id:"http-api-for-pipeline-calls"},"HTTP API for pipeline calls"),(0,i.kt)("p",null,"  Another option to call the backend is to define a chain of multiple commands to be executed in a pipeline script and run this pipeline script by a single HTTP ",(0,i.kt)("inlineCode",{parentName:"p"},"POST")," to ",(0,i.kt)("inlineCode",{parentName:"p"},"/pipeline"),". Again by using the request header ",(0,i.kt)("inlineCode",{parentName:"p"},"Content-Type")," and the request body, you can optionally set the body data for the pipeline."),(0,i.kt)("h3",{id:"http-methods-1"},"HTTP Methods"),(0,i.kt)("p",null,"You can call the command endpoint ",(0,i.kt)("inlineCode",{parentName:"p"},"/pipeline")," using different HTTP options:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Method"),(0,i.kt)("th",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"th"},"Content-Type")),(0,i.kt)("th",{parentName:"tr",align:null},"Request Body"),(0,i.kt)("th",{parentName:"tr",align:null},"Message Body"),(0,i.kt)("th",{parentName:"tr",align:null},"Execution"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"POST")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"application/json")),(0,i.kt)("td",{parentName:"tr",align:null},"A JSON pipeline document."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"null")," or set by the ",(0,i.kt)("inlineCode",{parentName:"td"},"body")," section of the pipeline."),(0,i.kt)("td",{parentName:"tr",align:null},"A pipeline set as JSON from the request body.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"POST")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"application/yaml")),(0,i.kt)("td",{parentName:"tr",align:null},"A YAML pipeline document."),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"null")," or set by the ",(0,i.kt)("inlineCode",{parentName:"td"},"body")," section of the pipeline."),(0,i.kt)("td",{parentName:"tr",align:null},"A pipeline set as YAML from the request body.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"POST")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"multipart/form-data")),(0,i.kt)("td",{parentName:"tr",align:null},"One part with ",(0,i.kt)("inlineCode",{parentName:"td"},'name="pipeline"')," with a YAML pipeline and one or more parts with ",(0,i.kt)("inlineCode",{parentName:"td"},'name="file"')," in the content disposition header. See ",(0,i.kt)("a",{parentName:"td",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST"},"how HTTP multipart works"),"."),(0,i.kt)("td",{parentName:"tr",align:null},"Content Collection referencing all ",(0,i.kt)("inlineCode",{parentName:"td"},"file"),"parts."),(0,i.kt)("td",{parentName:"tr",align:null},"A pipeline set as YAML from the ",(0,i.kt)("inlineCode",{parentName:"td"},"pipeline")," part and with a content collection created from all ",(0,i.kt)("inlineCode",{parentName:"td"},"file")," parts of the request body.")))),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Using the HTTP methd ",(0,i.kt)("inlineCode",{parentName:"p"},"GET")," with the ",(0,i.kt)("inlineCode",{parentName:"p"},"/pipeline")," endpoint is not possible and will cause an error."))),(0,i.kt)("h3",{id:"example-1-no-body-1"},"Example 1: No body"),(0,i.kt)("p",null,"In case you would like to execute a pipeline YAML script without body, you can use this curl:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST "https://hub-ns.pipeforce.net/api/v3/pipeline" \\\n  -H "Content-Type: application/yaml" \\\n  -u "username:password" \\\n  --data-binary @- << EOF\npipeline:\n - drive.read:\n     path: /my.pdf\n - pdf.stamp:\n     text: "Hello World!"\n - drive.save:\n     path: /my-stamped.pdf\nEOF\n')),(0,i.kt)("h3",{id:"example-2-with-body-embedded"},"Example 2: With body embedded"),(0,i.kt)("p",null,"In case you would like to execute a pipeline YAML script with body, which is embedded inside the YAML, you can use this curl:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST "https://hub-ns.pipeforce.net/api/v3/pipeline" \\\n  -H "Content-Type: application/yaml" \\\n  -u "username:password" \\\n  --data-binary @- << EOF\npipeline:\n  - log:\n      message: "BODY: #{body.text}"\n\nbody: {"text": "Hello World!"}\nEOF\n')),(0,i.kt)("h3",{id:"example-3-with-body"},"Example 3: With body"),(0,i.kt)("p",null,"Since a pipeline request with body data always requires at least two parts (pipeline part and at least one data part) in the request body, see ",(0,i.kt)("a",{parentName:"p",href:"#pipeline-yaml-multipart-body"},"Pipeline YAML (Multipart Body)")," below. "),(0,i.kt)("h3",{id:"example-4-with-multipart-body-1"},"Example 4: With multipart body"),(0,i.kt)("p",null,"Here\u2019s an example of an HTTP multipart request as defined by the HTTP specification. This example does multiple steps in one request: It uploads a PDF, puts a new text on the PDF and then stores it at server side:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'POST /api/v3/pipeline HTTP/1.1 \nHost: hub-acme.pipefore.net\nContent-Type: multipart/form-data;boundary="boundary" \n\n--boundary \nContent-Disposition: form-data; name="pipeline.yaml" \n\npipeline:\n - pdf.stamp:\n     text: "Hello World!"\n - drive.save:\n     path: /my-stamped.pdf \n--boundary \nContent-Disposition: form-data; name="my.pdf"; filename="my.pdf" \n\nBINARY DATA OF my.pdf\n--boundary--\n')),(0,i.kt)("h2",{id:"report-an-issue"},"Report an Issue"),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Your help is needed!")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"In case you're missing something on this page, you found an error or you have an idea for improvement, please ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/pipeforce/pipeforce.github.io/issues/new"},"click here to create a new issue"),". Another way to contribute is, to click ",(0,i.kt)("strong",{parentName:"p"},"Edit this page")," below and directly add your changes in GitHub. Many thanks for your contribution in order to improve PIPEFORCE!"))))}m.isMDXComponent=!0}}]);