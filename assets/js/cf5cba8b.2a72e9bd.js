"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[1694],{3905:(e,t,o)=>{o.d(t,{Zo:()=>c,kt:()=>k});var r=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function n(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function i(e,t){if(null==e)return{};var o,r,a=function(e,t){if(null==e)return{};var o,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)o=l[r],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)o=l[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):n(n({},t),e)),o},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var o=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),m=p(o),k=a,d=m["".concat(s,".").concat(k)]||m[k]||u[k]||l;return o?r.createElement(d,n(n({ref:t},c),{},{components:o})):r.createElement(d,n({ref:t},c))}));function k(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=o.length,n=new Array(l);n[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,n[1]=i;for(var p=2;p<l;p++)n[p]=o[p];return r.createElement.apply(null,n)}return r.createElement.apply(null,o)}m.displayName="MDXCreateElement"},104:(e,t,o)=>{o.r(t),o.d(t,{contentTitle:()=>n,default:()=>c,frontMatter:()=>l,metadata:()=>i,toc:()=>s});var r=o(7462),a=(o(7294),o(3905));const l={},n="Property Locking",i={unversionedId:"guides/propertystore/property_locks",id:"guides/propertystore/property_locks",isDocsHomePage:!1,title:"Property Locking",description:"What is a Property Lock?",source:"@site/docs/guides/propertystore/15_property_locks.md",sourceDirName:"guides/propertystore",slug:"/guides/propertystore/property_locks",permalink:"/docs/guides/propertystore/property_locks",editUrl:"https://github.com/pipeforce/pipeforce.github.io/edit/master/docs/guides/propertystore/15_property_locks.md",tags:[],version:"current",sidebarPosition:15,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Basics",permalink:"/docs/propertystore"},next:{title:"Trash Bin",permalink:"/docs/guides/propertystore/trash_bin"}},s=[{value:"What is a Property Lock?",id:"what-is-a-property-lock",children:[],level:2},{value:"How to create a Property Lock?",id:"how-to-create-a-property-lock",children:[{value:"The Lock Tag",id:"the-lock-tag",children:[],level:3},{value:"Lock exclusive to user",id:"lock-exclusive-to-user",children:[],level:3},{value:"Lock exclusive to role",id:"lock-exclusive-to-role",children:[],level:3},{value:"Lock exlusive to group",id:"lock-exlusive-to-group",children:[],level:3},{value:"Lock exclusive to namespace",id:"lock-exclusive-to-namespace",children:[],level:3},{value:"Global Lock",id:"global-lock",children:[],level:3},{value:"Trash Lock",id:"trash-lock",children:[],level:3}],level:2},{value:"How to remove a Property Lock?",id:"how-to-remove-a-property-lock",children:[{value:"Manually remove a Lock",id:"manually-remove-a-lock",children:[],level:3},{value:"Automatically remove a Lock",id:"automatically-remove-a-lock",children:[],level:3}],level:2},{value:"How to check for a Lock?",id:"how-to-check-for-a-lock",children:[],level:2},{value:"Report an Issue",id:"report-an-issue",children:[],level:2}],p={toc:s};function c(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"property-locking"},"Property Locking"),(0,a.kt)("h2",{id:"what-is-a-property-lock"},"What is a Property Lock?"),(0,a.kt)("p",null,"A lock in PIPEFORCE can be put on any property and hinders a user or a group of users altering this property. This can be useful for example to avoid double-edits with race conditions, for maintenance reasons or in state conditions. Just to name a few examples."),(0,a.kt)("p",null,"Such a lock in PIPEFORCE can be:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"exclusive to a user = only this particular user can edit this property"),(0,a.kt)("li",{parentName:"ul"},"exclusive to a role (permission) = only users with given role / permission can edit"),(0,a.kt)("li",{parentName:"ul"},"exclusive to a group = only users which are member of a certain group can edit this property"),(0,a.kt)("li",{parentName:"ul"},"exclusive to a namespace = only users within this namespace can edit this property"),(0,a.kt)("li",{parentName:"ul"},"global = no one can edit this property (except users with permission ",(0,a.kt)("inlineCode",{parentName:"li"},"ROLE_SYSTEM"),").")),(0,a.kt)("p",null,"A lock can also be generated using a time-to-live (ttl) value in order to remove the lock automatically from the property after this given amount of time has been expired. In case such a ttl is not set, the lock is not released automatically and must be removed manually. A lock can be removed by users, this lock is exclusive to or by the system."),(0,a.kt)("h2",{id:"how-to-create-a-property-lock"},"How to create a Property Lock?"),(0,a.kt)("p",null,"You can create a lock on a property using the command ",(0,a.kt)("a",{parentName:"p",href:"/docs/api/commands#propertylockcreate-v1"},(0,a.kt)("inlineCode",{parentName:"a"},"property.lock.create")),"."),(0,a.kt)("p",null,"Here is an example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - property.lock.create:\n      key: "global/app/myapp/data/mydata"\n')),(0,a.kt)("p",null,"This will create the default lock of type ",(0,a.kt)("inlineCode",{parentName:"p"},"user")," on a property with key ",(0,a.kt)("inlineCode",{parentName:"p"},"global/app/myapp/data/mydata"),".\nThis lock will be automatically set as exclusive to the currently logged-in user. "),(0,a.kt)("h3",{id:"the-lock-tag"},"The Lock Tag"),(0,a.kt)("p",null,"After a lock has been created, the response will return the lock tag which holds all required information about a lock in JSON format:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "ts": 1364409740897,\n  "ttl": null,\n  "type": "user",\n  "uuid": "79e08af3-5f16-40c7-8fb1-203e0c85376b",\n  "name": "someUsername",\n  "details": ""\n}\n')),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ts")," = The Unix timestamp this lock has been created in milliseconds."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"ttl")," = The time-to-live in milliseconds, after this lock must be removed automatically. If null, the lock will be kept until manually removed."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"type")," = One of ",(0,a.kt)("inlineCode",{parentName:"li"},"user"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"role"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"group"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"namespace"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"global")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"trash"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"uuid")," = The uuid of the user this lock is exclusive to. Only set in case the lock type is set to ",(0,a.kt)("inlineCode",{parentName:"li"},"user"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"name")," = This value depends on the lock type. If type is ",(0,a.kt)("inlineCode",{parentName:"li"},"user"),", this contains the username of the user, this lock is exclusive to (is automatically set by the backend). If type is one of ",(0,a.kt)("inlineCode",{parentName:"li"},"role"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"group")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"namespace"),", the name must be set to the name of the selected resource, this lock is exclusive to. For example the name of the role, group or namespace. If type is ",(0,a.kt)("inlineCode",{parentName:"li"},"global")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"trash")," the name is typically empty."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"details")," = Some additional, optional information with the lock.")),(0,a.kt)("h3",{id:"lock-exclusive-to-user"},"Lock exclusive to user"),(0,a.kt)("p",null,"A lock exclusive to a user allows only users  this particular user to alter the property."),(0,a.kt)("h3",{id:"lock-exclusive-to-role"},"Lock exclusive to role"),(0,a.kt)("p",null,"A lock exclusive to a role allows only users with this particular role / permission to alter the property."),(0,a.kt)("h3",{id:"lock-exlusive-to-group"},"Lock exlusive to group"),(0,a.kt)("p",null,"A lock exclusive to a group allows only users member of this particular group to alter the property."),(0,a.kt)("h3",{id:"lock-exclusive-to-namespace"},"Lock exclusive to namespace"),(0,a.kt)("p",null,"A namespace lock allows all users within the given namespace to alter the property."),(0,a.kt)("h3",{id:"global-lock"},"Global Lock"),(0,a.kt)("p",null,"A global lock denies alerting a property for all users except those with ",(0,a.kt)("inlineCode",{parentName:"p"},"ROLE_SYSTEM")," assigned."),(0,a.kt)("h3",{id:"trash-lock"},"Trash Lock"),(0,a.kt)("p",null,"A lock of type ",(0,a.kt)("inlineCode",{parentName:"p"},"trash")," is a special lock, since it not only puts a global lock on a property, it also makes the property invisible from most of the listings in the system. Differently to the other lock types, in case the ",(0,a.kt)("inlineCode",{parentName:"p"},"ttl")," is set: the property will be fully deleted after this time has been expired."),(0,a.kt)("p",null,"Also see the ",(0,a.kt)("a",{parentName:"p",href:"/docs/guides/propertystore/trash_bin"},"Trash Bin"),"."),(0,a.kt)("h2",{id:"how-to-remove-a-property-lock"},"How to remove a Property Lock?"),(0,a.kt)("h3",{id:"manually-remove-a-lock"},"Manually remove a Lock"),(0,a.kt)("p",null,"In order to manually remove a lock, use the command property.lock.remove."),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - property.lock.remove:\n      key: "global/app/mydata"\n')),(0,a.kt)("h3",{id:"automatically-remove-a-lock"},"Automatically remove a Lock"),(0,a.kt)("p",null,"In order to automatically remove a lock after a certain amount of time, use the parameter ",(0,a.kt)("inlineCode",{parentName:"p"},"ttl")," when creating the lock. This parameter defines a Unix timestamp in milliseconds after which to remove the lock."),(0,a.kt)("h2",{id:"how-to-check-for-a-lock"},"How to check for a Lock?"),(0,a.kt)("p",null,"TODO"),(0,a.kt)("h2",{id:"report-an-issue"},"Report an Issue"),(0,a.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Your help is needed!")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"In case you're missing something on this page, you found an error or you have an idea for improvement, please ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/pipeforce/pipeforce.github.io/issues/new"},"click here to create a new issue"),". Another way to contribute is, to click ",(0,a.kt)("strong",{parentName:"p"},"Edit this page")," below and directly add your changes in GitHub. Many thanks for your contribution in order to improve PIPEFORCE!"))))}c.isMDXComponent=!0}}]);