"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[3613],{3905:(e,n,t)=>{t.d(n,{Zo:()=>u,kt:()=>c});var i=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,a=function(e,n){if(null==e)return{};var t,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=i.createContext({}),p=function(e){var n=i.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},u=function(e){var n=p(e.components);return i.createElement(s.Provider,{value:n},e.children)},m={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},d=i.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=p(t),c=a,h=d["".concat(s,".").concat(c)]||d[c]||m[c]||o;return t?i.createElement(h,r(r({ref:n},u),{},{components:t})):i.createElement(h,r({ref:n},u))}));function c(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,r=new Array(o);r[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,r[1]=l;for(var p=2;p<o;p++)r[p]=t[p];return i.createElement.apply(null,r)}return i.createElement.apply(null,t)}d.displayName="MDXCreateElement"},6566:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var i=t(7462),a=(t(7294),t(3905));const o={},r="10. Jobs",l={unversionedId:"guides/jobs",id:"guides/jobs",title:"10. Jobs",description:"Sometimes it is necessary that you trigger the commands in your pipeline after a certain time interval. For this you can",source:"@site/docs/guides/100_jobs.md",sourceDirName:"guides",slug:"/guides/jobs",permalink:"/docs/guides/jobs",draft:!1,editUrl:"https://github.com/pipeforce/pipeforce.github.io/edit/master/docs/guides/100_jobs.md",tags:[],version:"current",sidebarPosition:100,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Webhooks",permalink:"/docs/guides/messaging/webhooks"},next:{title:"Basics",permalink:"/docs/forms-basics"}},s={},p=[{value:"Creating a Pipeline Job",id:"creating-a-pipeline-job",level:2},{value:"Schedules",id:"schedules",level:2},{value:"Fixed schedules",id:"fixed-schedules",level:3},{value:"Dynamic schedules",id:"dynamic-schedules",level:3},{value:"List registered Pipeline Jobs",id:"list-registered-pipeline-jobs",level:2},{value:"Report an Issue",id:"report-an-issue",level:2}],u={toc:p};function m(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"10-jobs"},"10. Jobs"),(0,a.kt)("p",null,"Sometimes it is necessary that you trigger the commands in your pipeline after a certain time interval. For this you can\nuse the concept of pipeline jobs in PIPEFORCE."),(0,a.kt)("h2",{id:"creating-a-pipeline-job"},"Creating a Pipeline Job"),(0,a.kt)("p",null,"To register a pipeline job, you can use the ",(0,a.kt)("a",{parentName:"p",href:"../api/commands#job-v1"},"job")," command."),(0,a.kt)("p",null,"Let's assume you have a pipeline like the one below which sends an email with current date and time:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n\n  - mail.send:\n      to: "user@company.tld"\n      subject: "Reminder"\n      message: "Hello, it\'s #{@date.nowIso8601()}"\n')),(0,a.kt)("p",null,"In case you would like to send this email every 2 minutes, you simply need to add the job command at the very beginning:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n\n  - job:\n      schedule: "EVERY_2_MIN"\n\n  - mail.send:\n      to: "user@company.tld"\n      subject: "Reminder"\n      message: "Hello, it\'s #{@date.nowIso8601()}"\n')),(0,a.kt)("p",null,"As soon as you save this pipeline in the property store, a new job will be scheduled which runs every 2 minutes and\nexecutes any command below."),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"The job command must be the very first command in the pipeline."),(0,a.kt)("li",{parentName:"ul"},"It's not allowed to have more than one such command per pipeline."))),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Whenever you delete a pipeline with a ",(0,a.kt)("inlineCode",{parentName:"p"},"job")," command in it, the according job will be deleted. The same is\ntrue in case you remove the ",(0,a.kt)("inlineCode",{parentName:"p"},"job")," command from the pipeline. In case you rename the pipeline or change parameters of the\ncommand, the pipeline job will be replaced by a new one. So make sure to change such a pipeline only in development\nmode, never in production.")),(0,a.kt)("h2",{id:"schedules"},"Schedules"),(0,a.kt)("h3",{id:"fixed-schedules"},"Fixed schedules"),(0,a.kt)("p",null,"There are different fixed schedules available:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"EVERY_2_MIN")," - Deprecated: Since version 9.0 this will always fallback to ",(0,a.kt)("inlineCode",{parentName:"li"},"EVERY_5_MIN"),". "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"EVERY_5_MIN")," - Runs every 5 minutes (Enterprise hosting only)."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"EVERY_15_MIN")," - Runs every 15 minutes."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"EVERY_30_MIN")," - Runs every 30 minutes."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"EVERY_45_MIN")," - Runs every 45 minutes."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"HOURLY")," - Runs at every full hour initially starting at a random minute."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"DAILY")," - Runs every day at the very morning on a random time between 2AM and 4AM."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"WEEKLY")," - Runs weekly at a random day and on a random time between 2AM and 4AM."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"MONTHLY")," - Runs monthly at a random day and on a random time between 2AM and 4AM.")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'pipeline:\n  - job:\n     schedule: "HOURLY"\n\n  # The commands, the job must execute go here...\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Since too many jobs can slow down your system drastically, make sure your jobs are well-designed\nand run in a minimal amount of time. There are some limits for jobs:"),(0,a.kt)("ul",{parentName:"admonition"},(0,a.kt)("li",{parentName:"ul"},"Max. of 20 jobs is allowed to be registered per namespace."),(0,a.kt)("li",{parentName:"ul"},"The max. execution time per job is 2 min. All jobs running longer will be cancelled by the system if required."))),(0,a.kt)("p",null,"In case you need to increase those limits, please ask the PIPEFORCE support (in case you're using the hosted version) or you can write a microservice for this."),(0,a.kt)("h3",{id:"dynamic-schedules"},"Dynamic schedules"),(0,a.kt)("p",null,"Dynamic triggers, also known as cron expressions, are not enabled by default."),(0,a.kt)("p",null,"Since they can slow down the system drastically and therefore need to be managed carefully, you\nhave to enable this kind of triggers separately by asking the PIPEFORCE support in case you're\nusing the hosted version of PIPEFORCE. "),(0,a.kt)("h2",{id:"list-registered-pipeline-jobs"},"List registered Pipeline Jobs"),(0,a.kt)("p",null,"In order to monitor the registered pipeline jobs, you can use the command ",(0,a.kt)("a",{parentName:"p",href:"../api/commands#joblist-v1"},"job.list"),". This will\nreturn a JSON with information about all currently registered pipeline jobs. Such a result can look like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'[\n    {\n        "pipelineKey": "/pipeforce/namespace/global/app/myapp/pipeline/somejob",\n        "cron": "4 */2 * * * ?",\n        "schedule": "EVERY_2_MIN", \n        "lastRun": "2022-05-07T06:26:04.022Z", \n        "lastDuration": "00:00:00.021",\n        "created": "2022-05-07T06:24:16.745Z",\n        "running": true\n    }\n]\n')),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Only Pipeline Jobs are shown here and no system-internally jobs.")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"pipelineKey")," = The property path of the pipeline which will be executed."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"cron")," = The cron expression automatically calculated by the system."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"schedule")," = The input schedule."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"lastRun")," = The time when this job was last executed in ISO-8061 format."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"lastDuration")," = The time, the last job execution took in the format ",(0,a.kt)("inlineCode",{parentName:"li"},"HH:mm:ss.SSS"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"created")," = The time when this job was created in ISO-8061 format."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"running")," = In case the job is currently actively running. If false, the job is registered, but paused.")),(0,a.kt)("p",null,"In case you would like to get information about a single job, you can use the ",(0,a.kt)("a",{parentName:"p",href:"../api/commands#jobstatus-v1"},"job.status")," command instead."),(0,a.kt)("h2",{id:"report-an-issue"},"Report an Issue"),(0,a.kt)("admonition",{title:"Your help is needed!",type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"In case you're missing something on this page, you found an error or you have an idea for improvement, please ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/pipeforce/pipeforce.github.io/issues/new"},"click here to create a new issue"),". Another way to contribute is, to click ",(0,a.kt)("strong",{parentName:"p"},"Edit this page")," below and directly add your changes in GitHub. Many thanks for your contribution in order to improve PIPEFORCE!")))}m.isMDXComponent=!0}}]);