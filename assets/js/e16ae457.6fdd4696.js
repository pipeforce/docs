"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[5730],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),u=p(n),h=i,m=u["".concat(s,".").concat(h)]||u[h]||c[h]||r;return n?a.createElement(m,o(o({ref:t},d),{},{components:n})):a.createElement(m,o({ref:t},d))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7997:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const r={title:"Headers Reference",sidebar_label:"Headers"},o=void 0,l={unversionedId:"api/headers",id:"api/headers",title:"Headers Reference",description:"Each pipeline can have optional headers defined. A pipeline header is similar to a HTTP header and defines a global \u201cconfiguration item\u201d for the overall execution of the pipeline. In the example below, you can see a pipeline with a header defined in the headers section:",source:"@site/docs/api/headers.md",sourceDirName:"api",slug:"/api/headers",permalink:"/docs/api/headers",draft:!1,editUrl:"https://github.com/pipeforce/pipeforce.github.io/edit/master/docs/api/headers.md",tags:[],version:"current",frontMatter:{title:"Headers Reference",sidebar_label:"Headers"},sidebar:"tutorialSidebar",previous:{title:"Built-In Functions",permalink:"/docs/api/functions"},next:{title:"Custom URIs",permalink:"/docs/api/uris"}},s={},p=[{value:"Headers Reference",id:"headers-reference",level:2},{value:"<code>apiVersion</code>",id:"apiversion",level:3},{value:"<code>authorization</code>",id:"authorization",level:3},{value:"<code>description</code>",id:"description",level:3},{value:"<code>exprPrefix</code>",id:"exprprefix",level:3},{value:"<code>mocksEnabled</code>",id:"mocksenabled",level:3},{value:"<code>onError</code>",id:"onerror",level:3},{value:"<code>runAs</code>",id:"runas",level:3},{value:"<code>runWhen</code>",id:"runwhen",level:3},{value:"<code>tracing</code>",id:"tracing",level:3},{value:"Report an Issue",id:"report-an-issue",level:2}],d={toc:p};function c(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Each pipeline can have ",(0,i.kt)("strong",{parentName:"p"},"optional")," headers defined. A pipeline header is similar to a HTTP header and defines a global \u201cconfiguration item\u201d for the overall execution of the pipeline. In the example below, you can see a pipeline with a header defined in the ",(0,i.kt)("inlineCode",{parentName:"p"},"headers")," section:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-yaml"},'headers:\n  description: "This is the hello world pipeline"\n  \npipeline:\n  - log:\n      message: "The value of header \'description\' is: #{headers.description}"\n')),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"You can access the header values using the ",(0,i.kt)("inlineCode",{parentName:"p"},"headers")," scope in a ",(0,i.kt)("a",{parentName:"p",href:"/docs/commands_pipelines#headers"},"Pipeline Expression (PE)"),".")),(0,i.kt)("h2",{id:"headers-reference"},"Headers Reference"),(0,i.kt)("p",null,"It is possible to create custom headers, and there are some pre-defined headers. Below, you can find a reference for the pre-defined headers and their meanings."),(0,i.kt)("h3",{id:"apiversion"},(0,i.kt)("inlineCode",{parentName:"h3"},"apiVersion")),(0,i.kt)("p",null,"It defines the version of the pipeline API to be used (for example: ",(0,i.kt)("inlineCode",{parentName:"p"},"v2"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"v3"),"). If not set, the latest version is used automatically.    "),(0,i.kt)("h3",{id:"authorization"},(0,i.kt)("inlineCode",{parentName:"h3"},"authorization")),(0,i.kt)("p",null,"It defines the authorization to be used for this pipeline. This has similar meaning as the HTTP ",(0,i.kt)("inlineCode",{parentName:"p"},"Authorization")," header. The possible values are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"RunAs USERNAME"),": This executes the given pipeline as user with a given username. This requires a valid seed authentication or a call from a trusted service."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Bearer TOKEN"),": This uses the given (JWT) token for authentication."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"Basic CREDENTIALS"),": This uses the given credentials for authentication.")),(0,i.kt)("p",null,"In case no authentication header is set in current pipeline, the existing authentication from the HTTP header or from the backend will be used instead. "),(0,i.kt)("h3",{id:"description"},(0,i.kt)("inlineCode",{parentName:"h3"},"description")),(0,i.kt)("p",null,"It is an optional description of this pipeline. The text may contain at max. 250 characters. This description is also used in logs and descriptions wherever possible.                                                                                                 "),(0,i.kt)("h3",{id:"exprprefix"},(0,i.kt)("inlineCode",{parentName:"h3"},"exprPrefix")),(0,i.kt)("p",null,"Sometimes, it is necessary to change the default prefix ",(0,i.kt)("inlineCode",{parentName:"p"},"#{")," of an expression to a different value. For example, if this clashes with some other expression engines. Example:",(0,i.kt)("br",null),(0,i.kt)("br",null),(0,i.kt)("inlineCode",{parentName:"p"},'expPrefix: "$"')," "),(0,i.kt)("h3",{id:"mocksenabled"},(0,i.kt)("inlineCode",{parentName:"h3"},"mocksEnabled")),(0,i.kt)("p",null,"In case this pipline contains command mocks using ",(0,i.kt)("a",{parentName:"p",href:"../api/commands#mockcommand-v1"},(0,i.kt)("inlineCode",{parentName:"a"},"mock.command")),", this header can switch on / off all mocks at once using a value of ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),".                                                                                                     "),(0,i.kt)("h3",{id:"onerror"},(0,i.kt)("inlineCode",{parentName:"h3"},"onError")),(0,i.kt)("p",null,"Also see ",(0,i.kt)("a",{parentName:"p",href:"/docs/guides/commands_pipelines/error_handling"},"Error Handling for Command and Pipelines"),"."),(0,i.kt)("p",null,"This is an optional value to define globally per pipeline what should happen if a single command in this pipeline has an error / exception. It is possible to define the short form or the long form of the header value, in order to specify additional parameters. Possible values are:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Short Value"),(0,i.kt)("th",{parentName:"tr",align:null},"Long Value"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"IGNORE")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{"action": "IGNORE"}')),(0,i.kt)("td",{parentName:"tr",align:null},"Only the exception message (not the full stacktrace) is logged as warn, but no exception is thrown. So, next command in the pipeline will be executed.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"LOG")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{"action": "LOG"}')),(0,i.kt)("td",{parentName:"tr",align:null},"The full stacktrace of the exception is logged as an error, but no exception is thrown. So, next command in the pipeline will be executed.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"THROW")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{"action": "THROW"}')),(0,i.kt)("td",{parentName:"tr",align:null},"An exception is thrown, and the pipeline execution is stopped at this command. This is the default behavior in case this header doesnt exist or is empty.")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"RETRY")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{"action": "RETRY", "times": 3, "wait": 2, "then": "THROW"}')),(0,i.kt)("td",{parentName:"tr",align:null},"If command caused an error, the command is again executed whereas all parameters are optional: ",(0,i.kt)("inlineCode",{parentName:"td"},"wait"),": the time to wait in seconds before the next retry starts (default = 3). ",(0,i.kt)("inlineCode",{parentName:"td"},"times"),": the number of retries before giving up (default = 1). ",(0,i.kt)("inlineCode",{parentName:"td"},"then"),": the action to do after the retry was not successfull (one of ",(0,i.kt)("inlineCode",{parentName:"td"},"IGNORE"),", ",(0,i.kt)("inlineCode",{parentName:"td"},"LOG"),", or ",(0,i.kt)("inlineCode",{parentName:"td"},"THROW"),")(default = ",(0,i.kt)("inlineCode",{parentName:"td"},"THROW"),").")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"N/A"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{"action": "ROLLBACK", "pipeline": "uri:property:global/app/.../rollback"}')),(0,i.kt)("td",{parentName:"tr",align:null},"If command caused an error, the given pipeline is loaded and executed which contains the rollback logics. ",(0,i.kt)("strong",{parentName:"td"},"Note: This action is a preview. It is not part of the main branch, yet."))))),(0,i.kt)("h3",{id:"runas"},(0,i.kt)("inlineCode",{parentName:"h3"},"runAs")),(0,i.kt)("p",null,"DEPRECATED Since version 7.0. Use the command ",(0,i.kt)("inlineCode",{parentName:"p"},"iam.run.as")," or the pipeline header ",(0,i.kt)("inlineCode",{parentName:"p"},"Authorization: RunAs USERNAME")," instead. A username of a user under which this pipeline must be executed as. It has the same functionality as the command ",(0,i.kt)("inlineCode",{parentName:"p"},"iam.run.as"),".                                                                                                      "),(0,i.kt)("h3",{id:"runwhen"},(0,i.kt)("inlineCode",{parentName:"h3"},"runWhen")),(0,i.kt)("p",null,"This header is primarily to configure a pipeline which is auto-executed on import or install, but can be useful also in other cases. It defines a PE which evaluated on execution of the pipeline. If this expression returns ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),", the pipeline is executed. Otherwise, it is skipped and a info message is logged. Furthermore, a warning is returned to the caller that this pipeline was skipped. If the header is not set, the pipeline is always executed.",(0,i.kt)("br",null),(0,i.kt)("br",null),"Here is an example to run the pipeline only when in test mode:  ",(0,i.kt)("br",null),(0,i.kt)("inlineCode",{parentName:"p"},"runWhen: \"#{@instance.profiles().contains('test')}\""),(0,i.kt)("br",null),(0,i.kt)("br",null),"Or when a certain namespace is set:  ",(0,i.kt)("br",null),(0,i.kt)("inlineCode",{parentName:"p"},"runWhen: \"#{@instance.namespace() == 'enterprise'}\""),"                                                                  "),(0,i.kt)("h3",{id:"tracing"},(0,i.kt)("inlineCode",{parentName:"h3"},"tracing")),(0,i.kt)("p",null,"If this header is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"false"),", the pipeline and its commands are not trace logged on execution. The default is ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),".     "),(0,i.kt)("h2",{id:"report-an-issue"},"Report an Issue"),(0,i.kt)("admonition",{title:"Your help is needed!",type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"In case you're missing something on this page, you found an error or you have an idea for improvement, please ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/pipeforce/pipeforce.github.io/issues/new"},"click here to create a new issue"),". Another way to contribute is, to click ",(0,i.kt)("strong",{parentName:"p"},"Edit this page")," below and directly add your changes in GitHub. Many thanks for your contribution in order to improve PIPEFORCE!")))}c.isMDXComponent=!0}}]);